# Telemetry Security Configuration
# Protects log files from direct web access

# Block access to logs directory
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Block direct access to log files
    RewriteRule ^logs/ - [F,L]

    # Block access to .jsonl files anywhere
    RewriteRule \.jsonl$ - [F,L]
</IfModule>

# Alternative method if mod_rewrite not available
<FilesMatch "\.(jsonl|log)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# Block access to config files
<FilesMatch "^config\.(php|local\.php)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# Security headers
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "DENY"
</IfModule>
