# Issue #90: Investigate Service Worker registration failures

## Problem Statement

Service Worker registration is failing on some devices:
- "Service Worker registration failed": 1 occurrence
- Low frequency but blocks offline functionality when it occurs

## Root Cause Analysis

Current SW registration error handling (in `src/main.js`) only logs the error message:
```javascript
onRegisterError(error) {
  logger.error('Service Worker registration failed', { error: error.message });
}
```

This doesn't capture enough context to diagnose the issue:
- No browser/device info
- No error stack trace
- No telemetry event for tracking

## Solution Design

### 1. Enhance error logging

Capture additional context when SW registration fails:
- Error message and stack trace
- Browser userAgent
- Whether this is a first-time visit
- Current URL/route

### 2. Add telemetry event

Send `sw_registration_failed` event to telemetry for tracking patterns.

### 3. Log successful registration details

Also log details on success to compare what works vs what fails.

## Files to Change

| File | Action |
|------|--------|
| `src/main.js` | **Modify** - Enhance SW registration callbacks |
| `docs/issues/90.md` | **Create** - This plan document |

## Implementation Steps

- [x] 1. Create plan document
- [x] 2. Enhance onRegisterError with detailed logging
- [x] 3. Add telemetry tracking for SW events
- [x] 4. Run tests and verify
- [x] 5. Create PR

## Telemetry Events Added

| Event | When | Data |
|-------|------|------|
| `sw_registered` | SW registered successfully | scope |
| `sw_offline_ready` | App ready for offline use | - |
| `sw_registration_failed` | SW registration error | error, userAgent, online |
| `sw_not_supported` | Browser doesn't support SW | userAgent |

## Acceptance Criteria

From issue #90:
- [x] Enhanced error logging for SW registration
- [x] Collect more telemetry data (userAgent, error details)
- [ ] Document findings (post-deploy analysis)
