# Configuration Guide

## Environment Variables

Saberloop uses environment variables for configuration. These are managed differently for local development and production.

## Local Development

### `.env` File

Create a `.env` file in the project root (copy from `.env.example`):

```bash
# API Configuration
ANTHROPIC_API_KEY=sk-ant-your-key-here

# Development Options
VITE_USE_REAL_API=false
```

**Important:** Never commit `.env` to version control. It's already in `.gitignore`.

### Available Variables

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `ANTHROPIC_API_KEY` | For real API | - | Your Anthropic Claude API key |
| `VITE_USE_REAL_API` | No | `false` | Use real API vs mock API |

### Vite Environment Variables

Variables prefixed with `VITE_` are exposed to the frontend:

```javascript
// Access in frontend code
const useRealApi = import.meta.env.VITE_USE_REAL_API === 'true';
```

Variables without `VITE_` prefix are only available server-side (e.g., in PHP backend).

## Production

### Setting Environment Variables

For FTP deployment, configure in `.env`:

| Variable | Value |
|----------|-------|
| `FTP_HOST` | Your FTP server hostname |
| `FTP_USER` | FTP username |
| `FTP_PASSWORD` | FTP password |

### Deployment

```bash
npm run build    # Build for production
npm run deploy   # FTP deploy to saberloop.com/app/
```

## API Configuration

### Mock API (Default for Development)

When `VITE_USE_REAL_API=false`:
- Uses pre-defined mock responses
- No API calls to external services
- Instant responses
- Good for UI development

### Real API (OpenRouter)

When `VITE_USE_REAL_API=true`:
- Uses OpenRouter for AI calls
- User authenticates with their own OpenRouter account
- API key stored client-side via OAuth

### OpenRouter Connection

Users can connect their own OpenRouter API key:
1. Go to Settings in the app
2. Click "Connect to AI Provider"
3. Authenticate with OpenRouter
4. Uses user's key directly from browser

## Build Configuration

### `vite.config.js`

```javascript
export default defineConfig({
  plugins: [VitePWA({...})],
  build: {
    outDir: 'dist',
    sourcemap: true
  },
  server: {
    port: 8888
  }
});
```

### `tailwind.config.js`

Tailwind CSS configuration for styling:

```javascript
export default {
  content: ['./index.html', './src/**/*.{js,ts,jsx,tsx}'],
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        'primary': '#4A90E2',
        'background-light': '#F8F9FA',
        'background-dark': '#121212',
        // ... more custom colors
      }
    }
  }
}
```

## PWA Configuration

### Service Worker

Configured via Vite PWA Plugin in `vite.config.js`:

```javascript
VitePWA({
  registerType: 'autoUpdate',
  workbox: {
    globPatterns: ['**/*.{js,css,html,ico,png,svg}'],
    runtimeCaching: [...]
  }
})
```

### Manifest

The manifest is generated by the Vite PWA plugin in `vite.config.js`:

```javascript
manifest: {
  name: 'Saberloop - Learn Anything, Practice Anything',
  short_name: 'Saberloop',
  theme_color: '#FF6B35',
  background_color: '#1a1a2e',
  display: 'standalone',
  // icons, screenshots, categories...
}
```

## Logging Configuration

### Log Levels

Logging is configured in `src/utils/logger.js`:

| Level | Environment | Description |
|-------|-------------|-------------|
| DEBUG | Development | Verbose debugging info |
| INFO | All | General information |
| WARN | All | Warnings |
| ERROR | All | Errors |

In production, DEBUG logs are hidden.

### Changing Log Level

```javascript
// In browser console
localStorage.setItem('loglevel', 'debug');
// Refresh page
```

## Database Configuration

IndexedDB settings in `src/core/db.js`:

| Setting | Value |
|---------|-------|
| Database name | `quizmaster` |
| Version | `1` |

## Switching Configurations

### Development with Mock API

1. Set `VITE_USE_REAL_API=false` in `.env`
2. Run `npm run dev`
3. No API key needed - uses mock responses

### Development with Real API

1. Set `VITE_USE_REAL_API=true` in `.env`
2. Run `npm run dev`
3. Connect to OpenRouter via Settings page in the app

### Production Build

1. Run `npm run build`
2. Run `npm run deploy` (requires FTP credentials in `.env`)

## Related Documentation

- [Installation Guide](./INSTALLATION.md)
- [Deployment](../architecture/DEPLOYMENT.md)
- [Troubleshooting](./TROUBLESHOOTING.md)
