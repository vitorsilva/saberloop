appId: com.saberloop.app
---
# Test 10: Ads Behavior When Offline
# Verifies app behavior when user is offline
# Sample quizzes should still work offline (cached)

# Launch and navigate to home
- launchApp
- runFlow:
    file: _shared/navigate-home.yaml

- takeScreenshot: 10-online-state

# Enable airplane mode (go offline)
- toggleAirplaneMode

# Wait for network state change
- extendedWaitUntil:
    timeout: 3000
    visible: ".*"

- takeScreenshot: 10-offline-state

# Sample quizzes should work offline - tap on one
- tapOn:
    text: ".*Solar System.*|.*Famous Scientists.*|.*Basic Math.*"

# Wait for quiz to load (from cache)
- extendedWaitUntil:
    visible: "Question.*of.*"
    timeout: 10000

- takeScreenshot: 10-offline-quiz-started

# Answer a couple questions offline
- tapOn:
    text: "A\\).*"
- tapOn:
    text: ".*Submit.*|.*Next.*"

- tapOn:
    text: "A\\).*"
    optional: true
- tapOn:
    text: ".*Submit.*|.*Next.*"
    optional: true

- takeScreenshot: 10-offline-quiz-progress

# Go back to home
- tapOn: "Home"

# Handle confirmation dialog if it appears
- tapOn:
    text: "OK"
    optional: true

# Go back online
- toggleAirplaneMode

# Wait for network state change
- extendedWaitUntil:
    timeout: 3000
    visible: ".*"

- takeScreenshot: 10-back-online

# Verify app is functional again
- extendedWaitUntil:
    visible: ".*Saberloop.*|.*Welcome.*|.*Start.*Quiz.*"
    timeout: 5000

- takeScreenshot: 10-home-recovered
